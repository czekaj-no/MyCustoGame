{% extends "store/account_base.html" %}

{% block title %}Twoje zamÃ³wienia | MyCustoGift{% endblock %}
{% block description %}PrzeglÄ…daj historiÄ™ zamÃ³wieÅ„, sprawdzaj statusy realizacji i wracaj do ulubionych prezentÃ³w zawsze, gdy chcesz.{% endblock %}

{% block account_content %}

<h2>Moje zamÃ³wienia</h2>

{% for order in orders %}
  {% for item in order.items.all %}

    <!-- NagÅ‚Ã³wek zamÃ³wienia -->
    <p class="order-header">
      ZamÃ³wienie nr {{ order.id }} z dnia {{ order.created|date:"d.m.Y â€“ H:i" }}
    </p>

    <!-- Blok jednego produktu -->
    <div class="order-block">

      <!-- TytuÅ‚: Kategoria + Nazwa gry -->
      <div class="order-title-row">
        {{ item.product.category|capfirst }}: <strong>{{ item.product.title }}</strong>
      </div>

      <!-- Tabela dodatkÃ³w -->
      <table class="order-table">
        <!-- NagÅ‚Ã³wki dodatkÃ³w -->
        <tr>
          <th>Wersja cyfrowa + QR</th>
          <th>Kartka A4 z QR</th>
          <th>Pendrive z grawerem</th>
          <th>PÅ‚yta + opakowanie</th>
        </tr>

        <!-- Ikony (âœ… / âŒ) -->
        <tr>
          <td>âœ…</td>
          <td>{% if item.includes_card %}âœ…{% else %}âŒ{% endif %}</td>
          <td>{% if item.includes_pendrive %}âœ…{% else %}âŒ{% endif %}</td>
          <td>{% if item.includes_cd %}âœ…{% else %}âŒ{% endif %}</td>
        </tr>

        <!-- Przyciski -->
        <tr>
          <td>
            <a href="{% url 'qr_codes' %}" class="mini-btn yellow">Generuj kod</a>
          </td>
          <td>
            {% if item.includes_card %}
              <a href="{% url 'qr_codes' %}" class="mini-btn">Kod do kartki</a>
            {% else %}
              <a href="{% url 'add_extra' item.id 'card' %}" class="mini-btn orange">Dokup</a>
            {% endif %}
          </td>
          <td>
            {% if not item.includes_pendrive %}
              <a href="{% url 'add_extra' item.id 'pendrive' %}" class="mini-btn orange">Dokup</a>
            {% endif %}
          </td>
          <td>
            {% if not item.includes_cd %}
              <a href="{% url 'add_extra' item.id 'cd' %}" class="mini-btn orange">Dokup</a>
            {% endif %}
          </td>
        </tr>
      </table>

<!-- Tabela: Status zamÃ³wienia -->
<table class="order-table">
  <tr class="gray-row">
    <th colspan="3" style="text-align: center;">Status zamÃ³wienia</th>
  </tr>
  <tr>
    <td style="text-align: left;">
 {% if item.order.status == "anulowane" %}
  ğŸ”´ Anulowane
{% elif item.order.status == "zrealizowane" or item.ready_file %}
  ğŸŸ¢ Zrealizowane
{% elif item.order.status == "w-trakcie" or item.customization.sent and not item.ready_file %}
  ğŸ”µ Realizujemy Twoje zamÃ³wienie
{% else %}
  ğŸŸ¡ Czekamy na Twoje dane
{% endif %}

    </td>

  <td style="text-align: center;">
 {% if item.order.status == "anulowane" %}
  âŒ ZamÃ³wienie anulowane

{% elif item.order.status == "zrealizowane" or item.ready_file %}
  <a href="{{ item.ready_file.url }}" class="mini-btn">Pobierz plik</a>
  <a href="{% url 'qr_codes' %}" class="mini-btn">Generuj kod</a>

{% elif item.order.status == "w-trakcie" %}

{% elif item.order.status == "nowe" %}
  <a href="{% url 'customization' %}" class="mini-btn yellow">Dodaj dane do personalizacji</a>

{% endif %}

</td>


    <td style="text-align: right;">
      {% if item.tracking_number %}
        Nr przesyÅ‚ki: {{ item.tracking_number }}
      {% else %}
        Nr przesyÅ‚ki:
      {% endif %}
    </td>
  </tr>
</table>

    </div>

  {% endfor %}
{% endfor %}

{% endblock %}
